# Bru-Seq pipeline: FASTQs to CPM normalized BigWigs

Bru-seq combines bromouridine (BrU) labeling and high-throughput sequencing.  
Cells are treated with bromouridine, which gets incorporated into newly synthesized RNA.  
Depending on the experimental design parameters, can potentially determine the relative turnover rates of different RNA species, RNA stability, processing, and degradation, and it is often used to study gene expression dynamics and regulatory mechanisms.

This can be used to look at transcription start sites, rate/pausing, alternative splicing, rna processing.

## Usage

To use the pipeline, edit the config.yaml file to specify relevant directories and parameters for various rules.

To run the pipeline, use the snakecharmer.sh script as an example bsub script.

## TODO

- implement locus specific comparison and metrics

## Rules

The following rules are defined in `Snakefile`:

`all`: specifies the input files that are required to run the pipeline.

`qc`: performs quality control on the input fastq files and generates html and zip files for each read.

`multiqc`: generates a multiqc report by aggregating the fastqc reports generated by the qc rule.

`trim`: trims the input fastq files and generates trimmed fastq files and a quality control report.

`align`: aligns the trimmed fastq files to a reference genome and generates a BAM file.

`sort_bam`: sorts the BAM file generated by the align rule.

`index_bam`: indexes the sorted BAM file generated by the sort_bam rule.

`feature_count`: counts the number of reads that map to each gene in the reference genome using the sorted BAM file generated by the sort_bam rule and a GTF file. Feature type can be modified to count different types.

`bam_to_bigwigs`: generates bigwig files from the sorted BAM file generated by the sort_bam rule.